import{_ as a}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as i,c as l,b as e}from"./app-B-zxItK3.js";const r={},h=e('<h1 id="mysql同步数据es" tabindex="-1"><a class="header-anchor" href="#mysql同步数据es" aria-hidden="true">#</a> MySQL同步数据ES</h1><ol><li>同步双写</li><li>异步双写</li><li>定时任务</li><li>数据订阅</li></ol><h2 id="同步双写" tabindex="-1"><a class="header-anchor" href="#同步双写" aria-hidden="true">#</a> 同步双写</h2><img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuIhEpinJACelJkNAoqz9LNWwjUtfvCPdStgVTYtaIaaiIKnAB4vLyAqC3lJXAYx9BqfCJrLmpKaiBibC3avDB4hEuChCAqajIajCJbNGrRL3qQzWfM2ef_1izfPdqpP0n5-it_viOnCNYYAGBh3vGEL6Uaydz3nRknIYvzdK3Szwrs6gHh4VgCiOcow7rBmKeFy0" alt="uml diagram" loading="lazy"><h3 id="优点" tabindex="-1"><a class="header-anchor" href="#优点" aria-hidden="true">#</a> 优点</h3><ol><li><p>简单</p><p>仅需要在需要同步数据的逻辑上增加往ElasticSearch写</p></li><li><p>保证实时性</p></li></ol><h3 id="缺点" tabindex="-1"><a class="header-anchor" href="#缺点" aria-hidden="true">#</a> 缺点</h3><ol><li><p>商品业务和搜索业务强耦合</p></li><li><p>扩展性差</p><p>需要定制搜索需求需求时, 还需要改动商品代码</p></li><li><p>ElasticSearch 和 MySQL 需要额外保证一致性</p><p>MySQL事务提交之后, 写入ElasticSearch出现网络异常, 那么ElasticSearch和MySQL的数据无法保证一致</p></li></ol><h2 id="异步双写" tabindex="-1"><a class="header-anchor" href="#异步双写" aria-hidden="true">#</a> 异步双写</h2><img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuIhEpinJACelJkNAoqz9LNWwjUtfvCPdStgVTYs4Y3oRCEVvbaLGaSBIrD9KXUp4jEn4hfJ4aiIanE9K1T_Au40V1DSr9x6u93CvE3MnA3c3YoiphoIrA2qnELL1LzSEnNm5AmL3lMUpjpoRjW4Y_6BzzcSRcxXGr80qWIq0gZP2KVriwePdlUkUxfgCgG7iGA06OxtdK-O_sRKSqvBdirgURUjurhYU2w8Mf0lPfq3D9df05I-sxCId6KLBNHs6_qpra5MysD3yVCgAP_ENlbY_2AgmR-dJ_iMene2SWXA6G7FCz1HUDCvwEg43wka9VK_RPZvjNOeQrWwfUId0E0K0" alt="uml diagram" loading="lazy"><p>与同步双写相比分析优缺点</p><h3 id="优点-1" tabindex="-1"><a class="header-anchor" href="#优点-1" aria-hidden="true">#</a> 优点</h3><ul><li>解耦合; 商品本身无需关注同步ElasticSearch的逻辑</li></ul><h3 id="缺点-1" tabindex="-1"><a class="header-anchor" href="#缺点-1" aria-hidden="true">#</a> 缺点</h3><ul><li>准实时, 存在MQ延迟</li><li>需要考虑额外组件的可靠性, Kafka, 搜索服务</li></ul><h2 id="定时任务" tabindex="-1"><a class="header-anchor" href="#定时任务" aria-hidden="true">#</a> 定时任务</h2><img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuIhEpinJACelJkNAoqz9LNWwjUtfvCPdStgVTYs4Y3oRCEVvbaLGaPJ4aiIanE9K1T_Au40V1DSr9x6u93CvE3MnA3c3YoiphoIrA2qnELL1LzSEnKm5AmL3lMUpjpoRjW4Y_6BzzcSRcxXGr80qWIq0gZP2KVriwePdlUkUxfhCXUmiXRew35kCzP1LF5qtwzdqRIysD3-VikBP_AKlrYzwEcS5nE2NqxUyd3NbHK_pqzbRdhQrFf_L0Z7fQSVq5mjNeDe3SXYALu4McUWfl6YSzNH21zHj4_gUjirysheKDKWSKlDIWC4D0000" alt="uml diagram" loading="lazy"><h3 id="优点-2" tabindex="-1"><a class="header-anchor" href="#优点-2" aria-hidden="true">#</a> 优点</h3><ol><li>简单</li></ol><h3 id="缺点-2" tabindex="-1"><a class="header-anchor" href="#缺点-2" aria-hidden="true">#</a> 缺点</h3><ol><li><p>无法保证实时性</p><p>保证实时性主要依赖于搜索服务的定时间隔</p></li></ol><h2 id="数据订阅" tabindex="-1"><a class="header-anchor" href="#数据订阅" aria-hidden="true">#</a> 数据订阅</h2><img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuIhEpinJACelJkNAoqz9LNWwjUtfvCPdStgVTYtaAYnDBKrLI4xCIyo1o3wRCEVvbaLGsPJ4aiIanE9K1T_Au40V1DSr9x6u93CvE3MnA3c3YoiphoIrA2qnELL1LzSEnNm5AmL3lMUpjpoRjW4Y_6BzzcSRcxXGr80qWIq0gZP2KVriwePdlUkUxfhC1P47gGIx5QZIM0_CUh5kqSiPhKcPUJdvwLmGEP0gP6y05PleFTlMyMBBJaodF9_L0fHwrhYU2qLBNHs6Hqpra5MysD3yVCgAP_ENlbY_2AgmR-dJ_iMene2SWX9OG7FCz1HUDCvwEg43whi9VK_RPZvjNOeQg0wfUId0o0C0" alt="uml diagram" loading="lazy"><h3 id="优点-3" tabindex="-1"><a class="header-anchor" href="#优点-3" aria-hidden="true">#</a> 优点</h3><ol><li><p>解耦合</p><p>利用canal订阅MySQL的binlog做到解耦合</p></li><li><p>无业务侵入</p><p>利用canal组件即可无需在商品代码上做改动</p></li><li><p>准实时</p><p>只存在binlog和业务回查的延迟</p></li><li><p>良好的扩展行</p><p>canal组件还支持各种数据库/客户端的写入适配器, 可以实现不同的数据写入需求, 例如 HBase</p></li></ol>',25),d=[h];function n(t,o){return i(),l("div",null,d)}const s=a(r,[["render",n],["__file","es.html.vue"]]);export{s as default};
